const SW_VERSION=.14,CACHE_ROOT="astraios-cache",CACHE_NAME=`${CACHE_ROOT}-v0.15`,urlList=["/","/app.webmanifest","/index.html","/runtime.js","/polyfills.js","/main.js","/styles.css","/assets/images/0.webp","/assets/images/1.webp","/assets/images/shiba1.webp","/assets/images/cover1.webp","/assets/images/cover2.webp","/assets/images/cover3.webp"];function getBaseUrl(e){let s=e.slice(9).indexOf("/");return e.slice(0,9+s)}self.addEventListener("install",e=>{e.waitUntil(caches.open(CACHE_NAME).then(s=>s.addAll(urlList)).catch(s=>{console.error(s)}))}),self.addEventListener("activate",e=>{e.waitUntil(caches.keys().then(s=>Promise.all(s.map(r=>{if(CACHE_NAME!==r&&r.startsWith(CACHE_ROOT))return caches.delete(r)}))))}),self.addEventListener("fetch",e=>{let s=e.request.url;console.log(s,"cache");let r=new Promise(async(n,i)=>{let a=await caches.match(e.request).then(t=>(console.log(s,t),t||null));a||(a=await fetch(e.request).then(t=>200!=t.status&&206!=t.status?null:(console.log("url, network success..."),caches.open(CACHE_NAME).then(c=>c.put(e.request,t)),t.clone())).catch(()=>null),a||(a=await caches.match(new URL("/",getBaseUrl(s))).then(t=>t||Response.error()))),n(a)});e.respondWith(r)});